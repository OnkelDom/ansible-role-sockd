---
sockd_user: sockd
sockd_group: sockd
sockd_bind_ip: "{{ ansible_default_ipv4.address }}"
#sockd_bind_ip: "0.0.0.0"
sockd_bind_port: 1080
sockd_bind_external_interface: "{{ ansible_default_ipv4 }}"
sockd_debug: ""
sockd_bind_ipv6_enabled: false
sockd_bind_ipv6: "{{ ansible_default_ipv6.address | default('') }}"
sockd_bind_port_ipv6: 1080
sockd_binary_install_dir: "/usr/local/bin"
sockd_log_folder: "/var/log/sockd"
sockd_config: "/etc/sockd.conf"
sockd_workers: 8
sockd_vip: "{{ ansible_hostname }}.{{ ansible_domain }}"
sockd_contact_mail: "my@mail.com"
sockd_firewalld_state: disabled
sockd_access_rules: {}

# Generate config as html file
sockd_caddy_generate_html_output: false
sockd_caddy_webserver_path: /var/www/
sockd_caddy_user: caddy
sockd_caddy_group: caddy

# Configure single Consul service
sockd_consul_service_register: false
consul_service_config:
  - id: "sockd_{{ ansible_hostname }}.{{ ansible_domain }}"
    name: "monitoring-blackbox_exporter"
    port: "{{ sockd_port }}"
    address: "{{ ansible_hostname }}.{{ ansible_domain }}"
    meta:
      __param_module: "tcp_connect"
      __scheme__: "http"
      __metrics_path__: "/probe"
    check:
      args: ["nc", "-w1", "-z", "{{ ansible_hostname }}.{{ ansible_domain }}", "{{ sockd_port | string }}"]
      interval: "60s"
      timeout: "10s"
    tags: ["prometheus", "metrics", "endpoint"]
